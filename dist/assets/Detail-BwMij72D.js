import{_ as C,r,c as p,h as D,l as x,b as o,d as t,n as h,e as v,f as m,g as L,a as B,t as a,p as N,q as R,o as n}from"./index-B-LOWIpF.js";import{u as z}from"./memoryStore-C62C9ihi.js";const S={key:0,class:"detail"},T=["src","alt"],V=["src"],A={class:"info"},I={class:"meta"},U={class:"story"},q={class:"actions"},E=["disabled"],P={key:1,class:"state"},j={key:0},F={key:1},G={__name:"Detail",setup(H){const _=N(),k=R(),s=z(),u=r(!0),c=r(""),e=r(null),i=r(!1),g=p(()=>e.value?.createdAt?new Date(e.value.createdAt).toLocaleString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):""),f=p(()=>e.value?s.isLiked(e.value.id):!1),y=async()=>{u.value=!0,c.value="";try{s.initialized||await s.loadMemories(),e.value=s.getMemoryById(_.params.id),e.value||(c.value="æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å›žå¿†ï¼Œè¯•è¯•è¿”å›žé¦–é¡µåˆ·æ–°åˆ—è¡¨")}finally{u.value=!1}},b=async()=>{e.value&&await s.likeMemory(e.value.id)},w=async()=>{if(!(!e.value||i.value||!window.confirm("ç¡®å®šåˆ é™¤è¿™æ®µæ—§æ—¶å…‰å—ï¼Ÿæ“ä½œä¸å¯æ’¤é”€ã€‚"))){i.value=!0;try{await s.deleteMemory(e.value.id),k.push("/")}finally{i.value=!1}}};return D(y),x(()=>_.fullPath,()=>{y()}),(M,l)=>{const d=B("RouterLink");return!u.value&&e.value?(n(),o("section",S,[t("div",{class:h(["media",e.value.mediaType])},[e.value.mediaType==="image"?(n(),o("img",{key:0,src:e.value.mediaUrl,alt:e.value.title},null,8,T)):(n(),o("video",{key:1,src:e.value.mediaUrl,controls:"",playsinline:""},null,8,V))],2),t("div",A,[v(d,{to:"/",class:"back"},{default:m(()=>[...l[0]||(l[0]=[L("â† è¿”å›žå›žå¿†å¢™",-1)])]),_:1}),t("p",I,a(e.value.year)+" å¹´ Â· "+a(g.value),1),t("h1",null,a(e.value.title),1),t("p",U,a(e.value.story),1),t("div",q,[t("button",{class:h({active:f.value}),onClick:b},a(f.value?"â¤ï¸ å·²å–œæ¬¢":"ðŸ¤ å–œæ¬¢")+" Â· "+a(e.value.likes),3),v(d,{to:"/timeline"},{default:m(()=>[...l[1]||(l[1]=[t("button",{class:"ghost"},"æŸ¥çœ‹æ—¶é—´è½´",-1)])]),_:1}),t("button",{class:"danger",disabled:i.value,onClick:w},a(i.value?"åˆ é™¤ä¸­...":"åˆ é™¤è¿™æ®µå›žå¿†"),9,E)])])])):(n(),o("section",P,[u.value?(n(),o("div",j,"æ­£åœ¨æ‰“å¼€è¿™æ®µå›žå¿†...")):(n(),o("div",F,[t("p",null,a(c.value||"æ²¡æœ‰æ‰¾åˆ°è¿™æ®µè®°å¿†"),1),v(d,{to:"/upload"},{default:m(()=>[...l[2]||(l[2]=[t("button",null,"åŽ»ä¸Šä¼ æˆ‘çš„å›žå¿†",-1)])]),_:1})]))]))}}},O=C(G,[["__scopeId","data-v-dcf74922"]]);export{O as default};
